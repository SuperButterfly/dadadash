(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[20],{b8c4:function(e,t,o){"use strict";o.r(t);var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("q-page-container",[o("q-page",[e.group?o("div",{staticClass:"row q-gutter-sm q-pa-md"},[o("div",{staticClass:"col-12"},[o("span",{staticClass:"text-h5"},[e._v(e._s(e.group.name))])]),o("div",{staticClass:"col-12"},[e._v("\n        Users in the group: "+e._s(e.usersInTheGroup.length)+"\n      ")]),o("div",{staticClass:"col-6 col-xl-4 col-lg-4 col-xs-12 col-sm-12 col-md-6"},[o("q-markup-table",{attrs:{flat:""}},[o("tbody",e._l(e.usersInTheGroup,(function(t){return o("tr",[o("td",[o("span",{staticClass:"text-bold"},[e._v(e._s(t.email))])]),o("td",{staticClass:"text-right"},[o("q-btn",{attrs:{size:"xs",icon:"fas fa-trash",flat:""},on:{click:function(o){return e.removeUserFromGroup(t)}}})],1)])})),0)])],1)]):e._e(),o("div",{staticClass:"row q-gutter-sm q-pa-md"},[o("div",{staticClass:"col-6 col-xl-4 col-lg-4 col-xs-12 col-sm-12 col-md-6"},[o("q-btn",{attrs:{label:"Delete group",color:"negative"},on:{click:function(t){return e.deleteGroup()}}}),o("q-btn",{staticClass:"float-right",attrs:{label:"Add user to group"},on:{click:function(t){e.showAddUserToGroup=!0}}})],1)]),o("q-dialog",{attrs:{persistent:""},model:{value:e.showAddUserToGroup,callback:function(t){e.showAddUserToGroup=t},expression:"showAddUserToGroup"}},[o("q-card",{staticStyle:{"min-width":"350px"}},[o("q-card-section",[o("div",{staticClass:"text-h6"},[e._v("Add user")])]),o("q-card-section",{staticClass:"q-pt-none"},[o("q-select",{attrs:{options:e.allUsers,"option-label":"email","option-value":"reference_id",autofocus:""},model:{value:e.newSelectedUser,callback:function(t){e.newSelectedUser=t},expression:"newSelectedUser"}})],1),o("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel"},on:{click:function(t){e.showAddUserToGroup=!1}}}),o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Add user"},on:{click:function(t){return e.addUserToGroup()}}})],1)],1)],1)],1)],1)},a=[],s=(o("8e6e"),o("8a81"),o("ac6a"),o("cadf"),o("06db"),o("456d"),o("9523")),n=o.n(s),l=o("2f62");function c(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?c(Object(o),!0).forEach((function(t){n()(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):c(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var u={name:"EditGroup",data:function(){return{group:null,showAddUserToGroup:!1,newSelectedUser:null,allUsers:[],usersInTheGroup:[]}},mounted:function(){var e=this;e.loadData({tableName:"usergroup",params:{query:JSON.stringify([{column:"reference_id",operator:"is",value:this.$route.params.groupId}])}}).then((function(t){if(console.log("Loaded group",t),!t.data||0===t.data.length)return e.$q.notify({message:"Group not found"}),void e.$router.back();e.group=t.data[0],e.loadData({tableName:"user_account",params:{page:{size:500}}}).then((function(t){e.allUsers=t.data})).catch((function(t){e.$q.notify({message:"Failed to get uses"})})),e.loadGroupUsers()}))},methods:i({removeUserFromGroup:function(e){console.log("remove user from group",e);var t=this;t.removeRelation({tableName:"usergroup",id:t.group.reference_id,relationName:"user_account_id",relationId:e.relation_reference_id}).then((function(e){console.log("Removed user ",e),t.loadGroupUsers()})).catch((function(e){t.$q.notify({message:"Failed to remove user from group"})}))},loadGroupUsers:function(){var e=this;e.loadDataRelations({tableName:"usergroup",relation:"user_account_id",reference_id:e.group.reference_id}).then((function(t){console.log("Users in this group",t),e.usersInTheGroup=t.data}))},addUserToGroup:function(){var e=this;console.log("add user to group",this.newSelectedUser),e.addManyRelation({tableName:"usergroup",id:e.group.id,relationName:"user_account_id",relationId:this.newSelectedUser.reference_id}).then((function(t){console.log("Added user group",t),e.$q.notify({message:"Added user to group"}),e.showAddUserToGroup=!1,e.loadGroupUsers()})).catch((function(t){e.$q.notify({message:JSON.stringify(t)})}))},deleteGroup:function(){var e=this;e.deleteRow({tableName:"usergroup",reference_id:e.group.id}).then((function(t){console.log("Deleted group",t),e.$q.notify({message:"Deleted group"}),e.$router.back()})).catch((function(t){e.$q.notify({message:JSON.stringify(t)})}))}},Object(l["b"])(["loadData","deleteRow","loadDataRelations","addManyRelation","removeRelation"]))},d=u,p=o("2877"),f=o("09e3"),g=o("9989"),m=o("2bb1"),b=o("9c40"),h=o("24e8"),v=o("f09f"),w=o("a370"),q=o("ddd8"),y=o("4b7e"),_=o("7f67"),U=o("eebe"),G=o.n(U),O=Object(p["a"])(d,r,a,!1,null,null,null);t["default"]=O.exports;G()(O,"components",{QPageContainer:f["a"],QPage:g["a"],QMarkupTable:m["a"],QBtn:b["a"],QDialog:h["a"],QCard:v["a"],QCardSection:w["a"],QSelect:q["a"],QCardActions:y["a"]}),G()(O,"directives",{ClosePopup:_["a"]})}}]);