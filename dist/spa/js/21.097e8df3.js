(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[21],{"8b24":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page-container",[a("q-page",[a("div",{staticClass:"q-pa-md q-gutter-sm"},[a("q-breadcrumbs",{scopedSlots:t._u([{key:"separator",fn:function(){return[a("q-icon",{attrs:{size:"1.2em",name:"arrow_forward"}})]},proxy:!0}])},[a("q-breadcrumbs-el",{attrs:{label:t.serverConfig.hostname,icon:"fas fa-home"}})],1)],1),a("q-separator"),a("div",{staticClass:"row",staticStyle:{"overflow-y":"scroll",height:"90vh"}},[a("div",{staticClass:"col-8 col-md-8 col-xs-12 col-lg-9 col-sm-6"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-6 col-md-6 col-lg-4 col-xl-4 col-xs-12 col-sm-12 q-pa-md q-gutter-sm"},[a("q-card",[a("q-card-section",[a("q-item",[a("q-item-section",{attrs:{avatar:""}},[a("q-avatar",[a("q-icon",{attrs:{size:"lg",name:"fas fa-user"}})],1)],1),a("q-item-section",[t.showHostnameEdit?t._e():a("span",{staticClass:"text-h4"},[t._v("Users")]),t.showHostnameEdit?t._e():a("span",{staticClass:"text-bold"},[t._v("@ "+t._s(t.serverConfig.hostname))]),t.showHostnameEdit?a("q-input",{attrs:{value:t.serverConfig.hostname,label:"Hostname"},on:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.saveHostname()}},model:{value:t.serverConfig.hostname,callback:function(e){t.$set(t.serverConfig,"hostname",e)},expression:"serverConfig.hostname"}}):t._e()],1),a("q-item-section",{attrs:{avatar:""}},[t.showHostnameEdit?t._e():a("q-icon",{staticStyle:{cursor:"pointer"},attrs:{name:"fas fa-edit",size:"xs"},on:{click:function(e){return t.changeHostname()}}}),t.showHostnameEdit?a("q-icon",{staticStyle:{cursor:"pointer"},attrs:{name:"fas fa-save",size:"xs"},on:{click:function(e){return t.saveHostname()}}}):t._e()],1)],1)],1),a("q-card-section",[a("div",{staticClass:"row q-pa-md"},[a("div",{staticClass:"col-4"},[a("span",{staticClass:"text-bold"},[t._v("Total")])]),a("div",{staticClass:"col-6 text-right"},[t._v("\n                    "+t._s(t.userAggregate.count)+"\n                  ")])]),a("div",{staticClass:"row q-pa-md"},[a("div",{staticClass:"col-4"},[a("span",{staticClass:"text-bold"},[t._v("User registrations")])]),a("div",{staticClass:"col-6 text-right"},[a("q-btn-toggle",{attrs:{size:"sm",flat:"",color:"white","toggle-color":"primary","toggle-text-color":"primary","text-color":"black",options:[{label:"2097057"==t.signUpPublicAvailable?"Enabled":"Enable",value:"2097057",disable:"2097057"==t.signUpPublicAvailable},{label:"2097057"!=t.signUpPublicAvailable?"Disabled":"Disable",value:"2097024",disable:!("2097057"==t.signUpPublicAvailable)}]},on:{click:function(e){return t.updateSignupActionPermission()}},model:{value:t.signUpPublicAvailable,callback:function(e){t.signUpPublicAvailable=e},expression:"signUpPublicAvailable"}})],1)]),a("div",{staticClass:"row q-pa-md"},[a("div",{staticClass:"col-4"},[a("span",{staticClass:"text-bold"},[t._v("Password Reset")])]),a("div",{staticClass:"col-6 text-right"},[t._v("\n                    Disabled\n                    ")])])])],1)],1),a("div",{staticClass:"col-6  col-md-6 col-lg-4 col-xl-3 col-xs-12 col-sm-12 q-pa-md q-gutter-sm"},[a("q-card",[a("q-card-section",[a("q-item",[a("q-item-section",{attrs:{avatar:""}},[a("q-avatar",[a("q-icon",{attrs:{size:"lg",name:"fas fa-database"}})],1)],1),a("q-item-section",[a("span",{staticClass:"text-h4"},[t._v("Data tables")])])],1)],1),a("q-card-section",[a("div",{staticClass:"row q-pa-md"},[a("div",{staticClass:"col-4"},[a("span",{staticClass:"text-bold"},[t._v("Total")])]),a("div",{staticClass:"col-6 text-right"},[t._v("\n                    "+t._s(t.tables().length)+"\n                  ")])])]),a("q-card-section",[a("div",{staticClass:"row "},[a("div",{staticClass:"col-12 q-pa-md q-gutter-sm"},[a("q-btn",{staticClass:"float-right",attrs:{icon:"list",round:""},on:{click:function(e){return t.$router.push("/tables")}}}),a("q-btn",{staticClass:"float-right",attrs:{round:"",icon:"add"},on:{click:function(e){return t.$router.push("/tables/create")}}})],1)])])],1)],1),a("div",{staticClass:"col-6 col-md-6 col-lg-4 col-xl-3 col-xs-12 col-sm-12 q-pa-md q-gutter-sm"},[a("q-card",[a("q-card-section",[a("q-item",[a("q-item-section",{attrs:{avatar:""}},[a("q-avatar",[a("q-icon",{attrs:{size:"lg",name:"fas fa-film"}})],1)],1),a("q-item-section",[a("span",{staticClass:"text-h4"},[t._v("Sites")])])],1)],1),a("q-card-section",[a("div",{staticClass:"row q-pa-md"},[a("div",{staticClass:"col-4"},[a("span",{staticClass:"text-bold"},[t._v("Active")])]),a("div",{staticClass:"col-6 text-right"},[t._v("\n                    "+t._s(t.siteAggregate.active)+"\n                  ")])]),a("div",{staticClass:"row q-pa-md"},[a("div",{staticClass:"col-4"},[a("span",{staticClass:"text-bold"},[t._v("Total")])]),a("div",{staticClass:"col-6 text-right"},[t._v("\n                    "+t._s(t.siteAggregate.total)+"\n                  ")])]),a("div",{staticClass:"row q-pa-md"},[a("div",{staticClass:"col-4"},[a("span",{staticClass:"text-bold"},[t._v("Cloud stores")])]),a("div",{staticClass:"col-6 text-right"},[t._v("\n                    "+t._s(t.cloudStoreAggregate.count)+"\n                  ")])])]),a("q-card-section",[a("div",{staticClass:"row "},[a("div",{staticClass:"col-12 q-pa-md q-gutter-sm"},[a("q-btn",{staticClass:"float-right",attrs:{round:"",icon:"list"},on:{click:function(e){return t.$router.push("/cloudstore/sites")}}})],1)])])],1)],1),a("div",{staticClass:"col-6  col-md-6 col-lg-4 col-xl-3 col-xs-12 col-sm-12 q-pa-md q-gutter-sm"},[a("q-card",[a("q-card-section",[a("q-item",[a("q-item-section",{attrs:{avatar:""}},[a("q-avatar",[a("q-icon",{attrs:{size:"lg",name:"fas fa-bolt"}})],1)],1),a("q-item-section",[a("span",{staticClass:"text-h4"},[t._v("Integrations")])])],1)],1),a("q-card-section",[a("div",{staticClass:"row q-pa-md"},[a("div",{staticClass:"col-4"},[a("span",{staticClass:"text-bold"},[t._v("API Specs")])]),a("div",{staticClass:"col-6 text-right"},[t._v("\n                    "+t._s(t.integrationAggregate.count)+"\n                  ")])]),a("div",{staticClass:"row q-pa-md"},[a("div",{staticClass:"col-4"},[a("span",{staticClass:"text-bold"},[t._v("Actions")])]),a("div",{staticClass:"col-6 text-right"},[t._v("\n                    "+t._s(t.actionAggregate.count)+"\n                  ")])])]),a("q-card-section",[a("div",{staticClass:"row "},[a("div",{staticClass:"col-12 q-pa-md q-gutter-sm"},[a("q-btn",{staticClass:"float-right",attrs:{label:"Add API Spec"}}),a("q-btn",{staticClass:"float-right",attrs:{label:"Create an action"}})],1)])])],1)],1)])]),a("div",{staticClass:"col-4  col-md-4 col-lg-3 col-xl-3 col-xs-12 col-sm-6 q-pa-md q-gutter-sm"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12"},[a("q-card",[a("q-card-section",[a("q-item",[a("q-item-section",{attrs:{avatar:""}},[a("q-avatar",[a("q-icon",{attrs:{size:"lg",name:"fas fa-plug"}})],1)],1),a("q-item-section",[a("span",{staticClass:"text-h4"},[t._v("Services")])])],1)],1),a("q-card-section",[a("div",{staticClass:"row q-pa-md"},[a("q-tooltip",[t._v("\n                    Resync configuration is required when you make a change to any of the following "),a("br"),a("ul",[a("li",[t._v("Table structure")]),a("li",[t._v("Service config change (service enabled/disabled)")]),a("li",[t._v("Backend config change (rate limit/hostname)")]),a("li",[t._v("Cloud storage and site source changes")]),a("li",[t._v("Mail server changes (added or removed hosts)")]),a("li",[t._v("Permission changes to tables and actions (row level permission change doesn't require\n                        this)\n                      ")])])]),a("div",{staticClass:"col-6"},[a("span",{staticClass:"text-bold"},[t._v("Resync Configuration\n                  ")])]),a("div",{staticClass:"col-4 text-right"},[a("q-btn",{attrs:{rounded:"",color:"primary",flat:"",size:"md",icon:"fas fa-sync"},on:{click:function(e){return t.reloadServer()}}})],1)],1),a("div",{staticClass:"row q-pa-md"},[a("div",{staticClass:"col-6"},[a("span",{staticClass:"text-bold"},[t._v("JSON API endpoint")])]),a("div",{staticClass:"col-4 text-right"},[a("q-icon",{attrs:{name:"fas fa-check",color:"green"}})],1)]),a("div",{staticClass:"row q-pa-md"},[a("div",{staticClass:"col-6"},[a("span",{staticClass:"text-bold"},[t._v("FTP service")])]),a("div",{staticClass:"col-4 text-right"},[a("q-btn-toggle",{attrs:{size:"sm",flat:"",color:"white","toggle-color":"black","toggle-text-color":"black","text-color":"primary",options:[{label:t.serverConfig["ftp.enable"]?"Enabled":"Enable",value:!0,disable:t.serverConfig["ftp.enable"]},{label:t.serverConfig["ftp.enable"]?"Disable":"Disabled",value:!1,disable:!t.serverConfig["ftp.enable"]}]},on:{click:function(e){return t.updateFtpEndpoint()}},model:{value:t.serverConfig["ftp.enable"],callback:function(e){t.$set(t.serverConfig,"ftp.enable",e)},expression:"serverConfig['ftp.enable']"}})],1)]),a("div",{staticClass:"row q-pa-md"},[a("div",{staticClass:"col-6"},[a("span",{staticClass:"text-bold"},[t._v("GraphQL endpoint")])]),a("div",{staticClass:"col-4 text-right"},[a("q-btn-toggle",{attrs:{size:"sm",flat:"",color:"white","toggle-color":"black","toggle-text-color":"black","text-color":"primary",options:[{label:t.serverConfig["graphql.enable"]?"Enabled":"Enable",value:!0,disable:t.serverConfig["graphql.enable"]},{label:t.serverConfig["graphql.enable"]?"Disable":"Disabled",value:!1,disable:!t.serverConfig["graphql.enable"]}]},on:{click:function(e){return t.updateGraphqlEndpoint()}},model:{value:t.serverConfig["graphql.enable"],callback:function(e){t.$set(t.serverConfig,"graphql.enable",e)},expression:"serverConfig['graphql.enable']"}})],1)]),a("div",{staticClass:"row q-pa-md"},[a("div",{staticClass:"col-6"},[a("span",{staticClass:"text-bold"},[t._v("IMAP endpoint")])]),a("div",{staticClass:"col-4 text-right"},[t.serverConfig["imap.enabled"]?a("q-icon",{attrs:{name:"fas fa-check",color:"green"}}):t._e(),t.serverConfig["imap.enabled"]?t._e():a("q-icon",{attrs:{name:"fas fa-times",color:"red"}})],1)]),a("div",{staticClass:"row q-pa-md"},[a("div",{staticClass:"col-6"},[a("span",{staticClass:"text-bold"},[t._v("Connection limit / IP")])]),t.editMaxConnections?t._e():a("div",{staticClass:"col-4 text-right",staticStyle:{"text-decoration-line":"underline","text-decoration-style":"dashed"},on:{click:function(e){t.editMaxConnections=!0}}},[t._v("\n                    "+t._s(t.serverConfig["limit.max_connections"])+"\n                  ")]),t.editMaxConnections?a("div",{staticClass:"col-4 text-right"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.serverConfig["limit.max_connections"],expression:"serverConfig['limit.max_connections']"}],staticStyle:{width:"100px"},attrs:{type:"number",size:"sm"},domProps:{value:t.serverConfig["limit.max_connections"]},on:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.saveMaxConnections()},input:function(e){e.target.composing||t.$set(t.serverConfig,"limit.max_connections",e.target.value)}}}),a("q-tooltip",[t._v("Press enter to save")]),a("i",{staticClass:"fas fa-times",staticStyle:{color:"grey",cursor:"pointer","padding-left":"5px"},on:{click:function(e){t.editMaxConnections=!1}}})],1):t._e()]),a("div",{staticClass:"row q-pa-md"},[a("div",{staticClass:"col-6"},[a("span",{staticClass:"text-bold"},[t._v("Allowed rate limit")])]),t.editRateLimit?t._e():a("div",{staticClass:"col-4 text-right",staticStyle:{"text-decoration-line":"underline","text-decoration-style":"dashed"},on:{click:function(e){t.editRateLimit=!0}}},[t._v("\n                    "+t._s(t.serverConfig["limit.rate"])+"\n                  ")]),t.editRateLimit?a("div",{staticClass:"col-4 text-right"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.serverConfig["limit.rate"],expression:"serverConfig['limit.rate']"}],staticStyle:{width:"100px"},attrs:{type:"number",size:"sm"},domProps:{value:t.serverConfig["limit.rate"]},on:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.saveRateLimit()},input:function(e){e.target.composing||t.$set(t.serverConfig,"limit.rate",e.target.value)}}}),a("q-tooltip",[t._v("Press enter to save")]),a("i",{staticClass:"fas fa-times",staticStyle:{color:"grey",cursor:"pointer","padding-left":"5px"},on:{click:function(e){t.editRateLimit=!1}}})],1):t._e()])])],1)],1)])])]),t.showHelp?t._e():a("q-page-sticky",{attrs:{position:"top-right",offset:[0,0]}},[a("q-btn",{attrs:{flat:"",fab:"",icon:"fas fa-question"},on:{click:function(e){t.showHelp=!0}}})],1),a("q-drawer",{attrs:{overlay:"",width:400,side:"right"},model:{value:t.showHelp,callback:function(e){t.showHelp=e},expression:"showHelp"}},[t.showHelp?a("q-scroll-area",{staticClass:"fit"},[a("help-page",{on:{closeHelp:function(e){t.showHelp=!1}}})],1):t._e()],1)],1)],1)},i=[],o=(a("8e6e"),a("8a81"),a("ac6a"),a("cadf"),a("06db"),a("456d"),a("9523")),n=a.n(o),l=a("2f62");function c(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function r(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?c(Object(a),!0).forEach((function(e){n()(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var d={name:"PageIndex",methods:r({saveMaxConnections:function(){var t=this;this.saveConfig({name:"limit.max_connections",value:this.serverConfig["limit.max_connections"]}).then((function(e){t.$q.notify({message:"Max connections per IP limit updated"}),t.editMaxConnections=!1})).catch((function(e){console.log("Failed to update max connections per IP limit",e),t.$q.notify({message:"Failed to update max connections per IP limit"})}))},saveRateLimit:function(){var t=this;this.saveConfig({name:"limit.rate",value:this.serverConfig["limit.rate"]}).then((function(e){t.$q.notify({message:"Rate limit updated"}),t.editRateLimit=!1})).catch((function(e){console.log("Failed to update rate limit",e),t.$q.notify({message:"Failed to update rate limit"})}))},updateSignupActionPermission:function(){var t=this;console.log("updateSignupActionPermission",this.signUpPublicAvailable,t.actionMap["signup"]);t.actionMap["signup"];t.updateRow({tableName:"world",id:t.selectedTable.reference_id,permission:JSON.stringify(t.tableSchema)}).then((function(){t.$q.notify({message:"Saved"})})).catch((function(e){console.log("Failed to remove group from default groups",e),t.$q.notify({message:"Failed to save"})}))},updateGraphqlEndpoint:function(){var t=this;console.log("Update graphql endpoint",this.serverConfig["graphql.enable"]),this.saveConfig({name:"graphql.enable",value:this.serverConfig["graphql.enable"]}).then((function(e){t.serverConfig["graphql.enable"]?t.$q.notify({message:"GraphQL endpoint enabled"}):(t.$q.notify({message:"GraphQL endpoint disabled"}),t.reloadServer()),t.showHostnameEdit=!1})).catch((function(e){console.log("Failed to update graphql endpoint",e),t.$q.notify({message:"Failed to update endpoint status"})}))},updateFtpEndpoint:function(){var t=this;console.log("Update ftp endpoint",this.serverConfig["ftp.enable"]),this.saveConfig({name:"ftp.enable",value:this.serverConfig["ftp.enable"]}).then((function(e){t.serverConfig["ftp.enable"]?t.$q.notify({message:"ftp enabled"}):(t.$q.notify({message:"ftp disabled"}),t.reloadServer()),t.showHostnameEdit=!1})).catch((function(e){console.log("Failed to update ftp endpoint",e),t.$q.notify({message:"Failed to update ftp status"})}))},saveHostname:function(){var t=this;this.saveConfig({name:"hostname",value:this.serverConfig.hostname}).then((function(e){t.$q.notify({message:"Hostname updated"}),t.reloadServer(),t.showHostnameEdit=!1})).catch((function(e){console.log("failed to upate hostname",e),t.$q.notify({message:"Failed to update hostname"})}))},changeHostname:function(){this.showHostnameEdit=!0},reloadServer:function(){console.log("Reload server");var t=this;t.executeAction({tableName:"world",actionName:"restart_daptin"}).then((function(e){t.$q.notify({message:"Server restarted"})})).catch((function(e){t.$q.notify({message:"Failed to restart"}),console.log("Failed to restart daptin",e)}))}},Object(l["b"])(["loadData","loadAggregates","loadServerConfig","executeAction","saveConfig","loadTables"])),data:function(){return r({text:"",editMaxConnections:!1,editRateLimit:!1,showHelp:!1,showHostnameEdit:!1,actionMap:{},userAggregate:{},cloudStoreAggregate:{},serverConfig:{},siteAggregate:{},integrationAggregate:{},actionAggregate:{},signUpPublicAvailable:"",resetPublicAvailable:!1},Object(l["c"])(["tables"]))},mounted:function(){var t=this;this.$q.loadingBar.start(),t.loadTables().then((function(){t.$q.loadingBar.stop()})),t.loadData({tableName:"action",params:{page:{size:500}}}).then((function(e){console.log("Actions",e);var a=e.data,s={},i=a.filter((function(t){return s[t.action_name]=t,"signup"===t.action_name}))[0];t.signUpPublicAvailable=i.permission;var o=a.filter((function(t){return"resetpassword"===t.action_name}))[0];o&&o.permission&&(t.resetPublicAvailable=!0),t.actionMap=s,console.log("Action map",s)})).catch((function(t){console.log("Failed to load actions",t)})),t.loadAggregates({tableName:"user_account",column:"count"}).then((function(e){console.log("User account aggregates",e),t.userAggregate=e.data[0]})),t.loadAggregates({tableName:"cloud_store",column:"count"}).then((function(e){console.log("cloud store aggregates",e),t.cloudStoreAggregate=e.data[0]})),t.loadAggregates({tableName:"site",column:"count",group:"enable"}).then((function(e){console.log("Site aggregates",e);var a=null,s=null;for(var i in e.data){var o=e.data[i];!0===o.enable||1===o.enable?a=o:s=o}t.siteAggregate={active:0,total:0},a&&(t.siteAggregate.active=a.count,t.siteAggregate.total+=a.count),s&&(t.siteAggregate.total+=s.count)})),t.loadAggregates({tableName:"action",column:"count"}).then((function(e){console.log("Action aggregates",e),t.actionAggregate=e.data[0]})),t.loadAggregates({tableName:"integration",column:"count"}).then((function(e){console.log("Integration aggregates",e),t.integrationAggregate=e.data[0]})),t.loadServerConfig().then((function(e){for(var a in e)"true"===e[a]?e[a]=!0:"false"===e[a]&&(e[a]=!1);console.log("Server config",e),t.serverConfig=e})).catch((function(t){console.log("Failed to load server config",t)}))}},g=d,v=a("2877"),u=a("09e3"),p=a("9989"),m=a("ead5"),f=a("0016"),b=a("079eb"),C=a("eb85"),h=a("f09f"),q=a("a370"),x=a("66e5"),_=a("4074"),w=a("cb32"),y=a("27f9"),A=a("6a67"),k=a("9c40"),P=a("05c0"),S=a("8f8e"),E=a("de5e"),$=a("9404"),H=a("4983"),O=a("eebe"),Q=a.n(O),F=Object(v["a"])(g,s,i,!1,null,null,null);e["default"]=F.exports;Q()(F,"components",{QPageContainer:u["a"],QPage:p["a"],QBreadcrumbs:m["a"],QIcon:f["a"],QBreadcrumbsEl:b["a"],QSeparator:C["a"],QCard:h["a"],QCardSection:q["a"],QItem:x["a"],QItemSection:_["a"],QAvatar:w["a"],QInput:y["a"],QBtnToggle:A["a"],QBtn:k["a"],QTooltip:P["a"],QCheckbox:S["a"],QPageSticky:E["a"],QDrawer:$["a"],QScrollArea:H["a"]})}}]);