(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[15],{a8e1:function(t,a,n){"use strict";n.r(a);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page-container",[a("q-page",[a("div",{staticClass:"row q-pa-md q-gutter-sm"},[a("div",{staticClass:"col-xl-3 col-lg-4 col-6 col-sm-8 col-xs-12 "},[a("q-input",{attrs:{label:"Search"},model:{value:e.filterWord,callback:function(t){e.filterWord=t},expression:"filterWord"}})],1),a("div",{staticClass:"col-6 q-pa-md"},[a("q-btn",{attrs:{fab:"",icon:"add",color:"primary"},on:{click:function(t){e.showCreateIntegrationDrawer=!0}}})],1)]),a("div",{staticClass:"row"},e._l(e.filteredIntegrations,(function(t){return a("div",{staticClass:"col-4 col-xl-3 col-lg-4 col-xs-12 col-sm-6 q-pa-md"},[a("q-card",[a("q-card-section",[a("span",{staticClass:"text-h6",staticStyle:{"text-overflow":"ellipsis",overflow:"hidden","white-space":"nowrap",display:"-webkit-box","-webkit-line-clamp":"1","-webkit-box-orient":"vertical"}},[e._v(e._s(t.name))])]),a("q-card-section",[a("span",[e._v("Format")]),a("span",{staticClass:"text-bold float-right"},[e._v(e._s(t.specification_format))])]),a("q-card-section",[a("span",[e._v("Language")]),a("span",{staticClass:"text-bold float-right"},[e._v(e._s(t.specification_language))])]),a("q-card-section",[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12"},[a("q-btn",{staticClass:"float-right",attrs:{size:"sm",label:"Edit integration"},on:{click:function(a){return e.showEditIntegration(t)}}})],1)])])],1)],1)})),0),a("q-drawer",{attrs:{overlay:"","content-class":"bg-grey-3",width:400,side:"right"},model:{value:e.showCreateIntegrationDrawer,callback:function(t){e.showCreateIntegrationDrawer=t},expression:"showCreateIntegrationDrawer"}},[a("q-card",{staticClass:"bg-grey-3",attrs:{flat:""}},[a("q-card-section",[a("span",{staticClass:"text-h6"},[e._v("Create integration")])]),a("q-card-section",[a("span",{staticClass:"text-bold"},[e._v("Upload any OpenAPI v2/v3 Spec")]),a("ul",[a("li",[e._v("YAML")]),a("li",[e._v("JSON")])])]),a("q-card-section",[a("q-form",{staticClass:"q-gutter-md q-pa-md"},[a("file-upload",{ref:"upload",staticClass:"bg-grey-3",staticStyle:{height:"300px",width:"100%"},attrs:{multiple:!0,drop:!0,"drop-directory":!1,"post-action":"/post.method","put-action":"/put.method"},on:{"input-file":e.fileAdded},model:{value:e.specFile,callback:function(t){e.specFile=t},expression:"specFile"}},[a("div",{staticClass:"container "},[0===e.specFile.length?a("span",{staticClass:"vertical-middle",staticStyle:{"padding-top":"40%"}},[e._v("Drop files or click to select "),a("br")]):e._e(),e.specFile.length>0?a("div",{staticClass:"row"},e._l(e.specFile,(function(t){return a("div",{staticClass:"col-12"},[e._v(e._s(t.name)+" - Error: "+e._s(t.error)+", Success:\n                    "+e._s(t.success)+"\n                  ")])})),0):e._e()])])],1)],1),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{attrs:{color:"negative"},on:{click:function(t){e.showCreateIntegrationDrawer=!1}}},[e._v("Cancel")])],1)],1)],1),a("q-drawer",{attrs:{overlay:"","content-class":"bg-grey-3",width:400,side:"right"},model:{value:e.showEditIntegrationDrawer,callback:function(t){e.showEditIntegrationDrawer=t},expression:"showEditIntegrationDrawer"}},[a("q-scroll-area",{staticClass:"fit"},[a("div",{staticClass:"row q-pa-md"},[a("div",{staticClass:"col-12"},[a("span",{staticClass:"text-h6"},[e._v("Edit integration")])]),a("div",{staticClass:"col-12"},[a("q-list",[a("q-item",[a("q-item-section",[a("q-input",{attrs:{label:"Name"},model:{value:e.newIntegration.name,callback:function(t){e.$set(e.newIntegration,"name",t)},expression:"newIntegration.name"}})],1)],1),a("q-item",[a("q-item-section",[a("q-checkbox",{attrs:{label:"Enable"},model:{value:e.newIntegration.enable,callback:function(t){e.$set(e.newIntegration,"enable",t)},expression:"newIntegration.enable"}},[a("q-tooltip",[e._v("\n                      Operations from schema are imported to be used in actions\n                    ")])],1)],1)],1),a("q-item",[a("q-item-section",[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12"},[a("q-btn",{staticClass:"float-left",attrs:{color:"negative"},on:{click:function(t){return e.deleteIntegration()}}},[e._v("Delete")]),a("q-btn",{staticClass:"float-right",attrs:{color:"primary"},on:{click:function(t){return e.updateIntegration()}}},[e._v("Save")]),a("q-btn",{staticClass:"float-right",on:{click:function(t){e.showEditIntegrationDrawer=!1}}},[e._v("Cancel")])],1)])])],1)],1)],1)])])],1)],1)],1)},o=[],r=(n("8e6e"),n("8a81"),n("ac6a"),n("cadf"),n("456d"),n("a481"),n("28a5"),n("551c"),n("06db"),n("aef6"),n("f751"),n("7f7f"),n("9523")),s=n.n(r),c=n("2f62");function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){s()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var g=n("651e"),f={name:"ApiCataloguePage",methods:d(d({updateIntegration:function(){var e=this;console.log("Update integration",e.newIntegration),e.updateRow({tableName:"integration",id:e.newIntegration.reference_id,enable:e.newIntegration.enable,name:e.newIntegration.name}).then((function(t){e.$q.notify({message:"Updated"}),e.refresh(),e.showEditIntegrationDrawer=!1})).catch((function(t){e.$q.notify({message:"Failed to update"})}))},fileAdded:function(t){var a=t.file,n=this;this.fileIsBeingLoaded=!0,console.log("File to read",a);var i=Object.assign({},this.newIntegration);a.name.toLowerCase().endsWith(".yaml")||a.type.toLowerCase().endsWith("yaml")?i.specification_format="yaml":i.specification_format="json";var o=new Promise((function(t,n){var i=a.name,o=(a.type,new FileReader);o.onload=function(e){t(e)},o.onerror=function(){console.log("Failed to load file onerror",e,arguments),n(i)},o.readAsDataURL(a)}));o.then((function(t){console.log("Spec file added",i,n.specFile),console.log("File data",t);var o=atob(t.target.result.split("base64,")[1]);switch(o.indexOf("openapi: 3")>-1&&(i.specification_language="openapiv3"),o.indexOf("openapi: 2")>-1&&(i.specification_language="openapiv2"),o.indexOf("swagger: 2")>-1&&(i.specification_language="openapiv2"),o.indexOf('"openapi": "3')>-1&&(i.specification_language="openapiv3"),o.indexOf('"openapi": "2')>-1&&(i.specification_language="openapiv2"),o.indexOf('"swagger": "2.0"')>-1&&(i.specification_language="openapiv2"),o.indexOf('"swagger": "3.0"')>-1&&(i.specification_language="openapiv3"),i.specification_format){case"json":try{var r=JSON.parse(o);i.name=r.info?r.info.name?r.info.name:r.info.title:r.host,i.name&&0!==i.name.length||(i.name=a.name)}catch(e){console.log("Failed to parse json content",e)}break;case"yaml":try{o=o.replace(/[^\x20-\x7E\n\t\r]/g,"");r=g.load(o,"utf8");i.name=r.info?r.info.name||r.info.title||r.info["x-providerName"]:r.servers?r.servers[0].url:r.host,n.$q.notify({message:"YAML spec parsed, uploading...",type:"positive"})}catch(e){return n.$q.notify({message:"Failed to parse YAML file: "+e.message,type:"negative"}),console.log("Failed to parse yaml content",e),void console.log(o)}i.name&&0!==i.name.length||(i.name=a.name);break;default:i.name="new integration"}i.specification=o,n.createIntegration(i),n.fileIsBeingLoaded=!1}))},showEditIntegration:function(e){this.selectedIntegration=e,this.showEditIntegrationDrawer=!0,this.newIntegration.name=e.name,this.newIntegration.root_path=e.root_path,this.newIntegration.enable="1"===e.enable||1===e.enable||!0===e.enable,this.newIntegration.reference_id=e.reference_id},deleteIntegration:function(){var e=this;console.log("Delete integration",this.selectedIntegration),this.deleteRow({tableName:"integration",reference_id:this.selectedIntegration.id}).then((function(t){e.showEditIntegrationDrawer=!1,e.selectedIntegration={},e.$q.notify({title:"Success",message:"Integration deleted"}),e.refresh()})).catch((function(t){e.$q.notify({title:"Failed",message:JSON.stringify(t)})}))},editIntegration:function(){var e=this;console.log("Delete integration",this.selectedIntegration),this.newIntegration.tableName="integration",this.newIntegration.id=this.selectedIntegration.id,this.updateRow(this.newIntegration).then((function(t){e.showEditIntegrationDrawer=!1,e.selectedIntegration={},e.$q.notify({title:"Success",message:"Integration updated"}),e.refresh()})).catch((function(t){e.$q.notify({title:"Failed",message:JSON.stringify(t)})}))},createIntegration:function(e){var t=this;console.log("new integration",e),e.tableName="integration",t.createRow(e).then((function(e){t.user={},t.$q.notify({message:"Integration specification imported, re-sync to start using in actions",type:"positive"}),t.refresh()})).catch((function(e){e["0"]||e[0]?t.$q.notify({message:"Failed to create integration"+e[0].title,type:"negative"}):t.$q.notify({message:"Failed to create integration: "+(e.message?e.message:JSON.stringify(e)),type:"negative"})}))}},Object(c["b"])(["loadData","getTableSchema","createRow","deleteRow","updateRow","executeAction"])),{},{refresh:function(){var e="integration",t=this;this.loadData({tableName:e,params:{fields:"name,specification_language,specification_format,enable,reference_id",page:{size:500}}}).then((function(e){console.log("Loaded data",e),t.integrations=e.data}))}}),data:function(){return d({text:"",fileIsBeingLoaded:!1,filterWord:null,selectedIntegration:{},showHelp:!1,specFile:[],newIntegration:{name:null,enable:!0,specification_format:null,specification:null,authentication_type:"token",authentication_specification:"{}",specification_language:null},showCreateIntegrationDrawer:!1,showEditIntegrationDrawer:!1,filter:null,integrations:[],columns:[{name:"name",field:"name",label:"cloud name",align:"left",sortable:!0}]},Object(c["d"])([]))},mounted:function(){this.refresh()},computed:d(d({filteredIntegrations:function(){var e=this;return console.log("filtered integragtions",e.filterWord,e.integrations),e.filterWord?this.integrations.filter((function(t){return t.name.toLowerCase().indexOf(e.filterWord.toLowerCase())>-1})):this.integrations}},Object(c["c"])(["selectedTable"])),Object(c["d"])([])),watch:{}},p=f,u=n("2877"),m=n("09e3"),h=n("9989"),w=n("27f9"),b=n("9c40"),v=n("f09f"),I=n("a370"),y=n("9404"),_=n("0378"),q=n("4b7e"),C=n("4983"),O=n("1c1c"),x=n("66e5"),D=n("4074"),k=n("8f8e"),F=n("05c0"),S=n("eebe"),j=n.n(S),E=Object(u["a"])(p,i,o,!1,null,null,null);a["default"]=E.exports;j()(E,"components",{QPageContainer:m["a"],QPage:h["a"],QInput:w["a"],QBtn:b["a"],QCard:v["a"],QCardSection:I["a"],QDrawer:y["a"],QForm:_["a"],QCardActions:q["a"],QScrollArea:C["a"],QList:O["a"],QItem:x["a"],QItemSection:D["a"],QCheckbox:k["a"],QTooltip:F["a"]})}}]);