(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[14],{2837:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-layout",{attrs:{view:"lHh Lpr lFf"}},[n("router-view")],1)},o=[],r=(n("8e6e"),n("8a81"),n("ac6a"),n("cadf"),n("06db"),n("456d"),n("967e")),c=n.n(r),u=(n("7f7f"),n("96cf"),n("fa84")),s=n.n(u),i=(n("28a5"),n("c47a")),l=n.n(i),m=n("2f62"),d=n("bf3a");function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return n.indexOf(e)===t}var w={name:"GuestLayout",components:{BaseViewContainer:d["default"]},methods:b({},Object(m["b"])(["loadModel","loadData"])),meta:function(){return{title:this.currentItem?this.currentItem.document_name:"Login"}},computed:{workspaces:function(){var e=this,t=this.documents.map((function(t){var n=t.document_path.split("/")[1];return e.workspaceMap[n]||(e.workspaceMap[n]={items:[]}),e.workspaceMap[n].items.push(t),n})).filter(f);return t.sort((function(e,t){return e.toLowerCase()>t.toLowerCase()})),console.log("Workspace name",t),t}},mounted:function(){console.log("mounted guest layout",this.documentTable());var e=this;e.$q.loading.show(),e.loadModel(["world","document"]).then(s()(c.a.mark((function t(){return c.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.loadData({tableName:"document",params:{page:{size:10},query:JSON.stringify([{column:"mime_type",operator:"like",value:"workspace/%"}]),included_relations:"document_content"}}).then((function(t){e.$q.loading.hide(),console.log("document table is public",t.data),e.documents=t.data,e.documents.length>0&&(e.leftDrawerOpen=!0);for(var n=0;n<e.documents.length;n++){var a=e.documents[n],o=a;if(a.document_content)try{var r=JSON.parse(atob(a.document_content[0].contents));o=b(b({},a),r)}catch(c){console.log("Failed to read contents of item",c,a),o=a}o.targetTable||(o.attributes&&o.attributes.TableName?o.targetTable=e.tableMap[o.attributes.TableName]:o.target&&o.target.name&&(o.targetTable=e.tableMap[o.target.name])),e.baseItemConfigMap[a.document_name]=o,"workspace/root"!==a.mime_type&&"workspace/base"!==a.mime_type&&null===e.currentItem&&(e.$route.params.document_name?e.$route.params.document_name===a.document_name&&(e.currentItem=a):(e.currentItem=a,e.$router.push("/guest/"+a.document_name)))}})).catch((function(t){e.$q.loading.hide(),console.log("Document table is not public",t)}));case 1:case"end":return t.stop()}}),t)})))).catch((function(t){e.$q.loading.hide(),console.log("No models available, lets wait for login",t)}))},data:function(){return b({leftDrawerOpen:!1,baseItemConfigMap:{},currentItem:null,baseItemComponentMap:{view:"edit-data-table",table:"edit-data-table",document:"document-editor",folder:"file-browser",spreadsheet:"spreadsheet-editor",calendar:"calendar-view"},rightDrawerOpen:!1,workspaceMap:{},documents:[]},Object(m["c"])(["documentTable","baseItemTypes"]))}},g=w,h=n("2877"),O=n("4d5a"),y=n("eebe"),v=n.n(y),_=Object(h["a"])(g,a,o,!1,null,null,null);t["default"]=_.exports;v()(_,"components",{QLayout:O["a"]})}}]);